<div class='hidden' id='deployment_summary_clipping'>
From: {{abs_url}}
App URL: {{formatted_data.path}}
App IP: {{formatted_data.vip}}
Servers:
{{formatted_data.clippy.server_data}}
Databases:
{{formatted_data.clippy.database_data}}
Load balancers:
{{formatted_data.clippy.lb_data}}
Applications:
User:     {{formatted_data.username}}
Password: {{formatted_data.password}}
Priv Key: {{formatted_data.private_key}}
</div>

<div class="entries container-fluid" ng-init="load()">
  <div class="entry well">
    <div class="row-fluid">
      <div class="span2">
        <ng-include src="'/partials/deployments/_deployment_sidebar.html'"></ng-include>
      </div>

      <div class="span10 deployment_container" style="background-image: url({{data.blueprint['meta-data']['reach-info'].tattoo}})">
        <div>
          <h3 style="display: inline">
            {{data.name || data.blueprint.name}}
          </h3>
          <p>
            <a ng-href="/deployments/new?blueprint={{get_blueprint_url(data)}}">
              {{data.blueprint.name}}
            </a>
            by
            <span>
              <a ng-href="/{{data.tenantId}}/deployments" ng-hide="is_admin()">{{data['created-by']}}</a>
              <a ng-href="/admin/deployments?tenant_id={{data.tenantId}}" ng-show="is_admin()">{{data['created-by']}}</a>
            </span>:
            <span id="status" class="label" ng-class="{
              'label-info': data.status == 'PLANNED',
              'label-success': data.status == 'UP' || data.status == 'LAUNCHED' || data.status == 'ACTIVE',
              'label-warning': data.status == 'ALERT' || data.status == 'DELETING' || data.status == 'BUILD',
              'label-important': data.status == 'FAILED' || data.status == 'UNREACHABLE' || data.status == 'DOWN',
              'label-inverse': data.status == 'DELETED'
            }">
              {{data.display_status}}
            </span>
            <br />

            {{data.environment.name}}
            <br />

            <span class="cm-tips" tooltip="{{data.created | formattedFullDate}}" tooltip-placement="bottom">
              {{data.created | formattedDate}}
            </span>
          </p>

          <div class="progress" style="height: 5px">
            <div class="bar" style="width: {{percentComplete}}%;"></div>
          </div>

        </div>

        <div class="row-fluid">

          <div class="span7">
            <ng-include src="'/partials/deployments/_details.html'"></ng-include>

            <ng-include src="'/partials/deployments/_infrastructure.html'"></ng-include>
          </div>

          <div class="span5" style="position: relative;">
            <ng-include src="'/partials/deployments/_edit_nodes.html'"
                        ng-show="available_services(data).length > 0"></ng-include>

            <cm-tree-view id="deployment_tree" data="tree_data"
                          select-node="toggle_selected_node"
                          clickable-node="is_scalable_service"
                          width="640" height="480"></cm-tree-view>

            <div style="position: absolute; right: 10px; bottom: 90px;">
              <span class="label label-info">{{count}}</span> tasks total<br />
              <span class="label label-success">{{taskStates['completed'] + taskStates['ready']}}</span> completed<br />
              <span class="label label-warning">{{taskStates['waiting']}}</span> in progress<br />
              <span class="label label-important">{{taskStates['error']}}</span> errored out<br />
              <span class="label">{{taskStates['future'] + taskStates['likely'] + taskStates['maybe']}}</span> waiting<br />
            </div>

            <div class="alert controls">
              You can access an <a ng-href="{{data.operation.link}}">advanced</a>
              view of the workflow to manage any errors or hack at the workflow.
            </div>

          </div>
        </div>

        <hr>

        <div class="row-fluid">
          <ng-include src="'/partials/deployments/_raw_source.html'"></ng-include>
        </div>

      </div>
    </div>
  </div>
</div>
