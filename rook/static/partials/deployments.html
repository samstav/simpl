<div class="entries container-fluid" ng-init="load()">
  <div class='row-fluid'>
    <div class='span2 sidebar-left'>

      <div class='group'>
        <h5><i class="icon-picture"></i> Deployments</h5>
        <a ng-class="{disabled: !is_selected()}" ng-click="sync_deployments()">Sync</a>
        <i ng-class="{disabled: !is_selected()}" class="icon-question-sign pull-right" ng-hide="is_selected()" tooltip="Select a deployment"></i>
      </div>

      <div class='group'>
        <h5><i class="icon-filter"></i> Filters</h5>

        <input ng-change="applyFilters()" ui-date ng-model="filters.start_date" ui-date-format="yy-mm-dd" placeholder="Start date" type="text" class="span10" />
        <input ng-change="applyFilters()" ui-date ng-model="filters.end_date" ui-date-format="yy-mm-dd" placeholder="End date" type="text" class="span10" />

        <h5> Status</h5>
        <label class="filter" ng-repeat="filter in filter_list">
          <input type="checkbox" ng-model="filter.active" ng-click="applyFilters()">
          <span>{{filter.name | capitalize}}</span>
        </label>

        <div ng-show="auth.is_admin()">
          <h5> Tenant Tag</h5>
          <label class="filter" ng-repeat="filter in filters.tenant_tag">
            <input type="checkbox" ng-model="filter.active" ng-click="applyFilters()">
            <span>{{filter.name | capitalize}}</span>
          </label>
        </div>

        <h5> Search</h5>
        <form>
          <input class="span10" type="text" placeholder="ex.: wordpress" ng-model="query" ng-change="applyFilters()" />
          <i class="icon-question-sign pull-right" tooltip="Press &lt;return&gt; to apply filter to all results"></i>
        </form>
      </div>

    </div>

    <div class='span10'>
      <table class="table table-striped">
        <thead>
          <tr>
            <th class="id">ID</th>
            <th>Name</th>
            <th>Blueprint</th>
            <th ng-show="is_admin(true)">Tenant</th>
            <th class='text-center'>Status</th>
            <th>Created</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="deployment in items | filter: query | orderBy:'-created'" ng-click="select_toggle(deployment)" ng-class="{info: selected_deployments[deployment.id]}">
            <td>
              <input name="{{deployment.id}}" type="checkbox" ng-model="selected_deployments[deployment.id]" ng-click="select_toggle(deployment)">
              <ng-include src="'/partials/deployment_settings.html'"></ng-include>
              <a ng-href="/{{deployment.tenantId}}/deployments/{{deployment.id}}">{{deployment.id | truncate:15}}</a>
            </td>
            <td>{{deployment.name}}</td>
            <td>{{deployment.blueprint.name}}</td>
            <td ng-show="is_admin(true)">
              {{deployment.tenantId}}
              <span class="tenant_tag" ng-repeat="tag in tenant_tags(deployment.tenantId)" ng-show="!is_impersonating()">
                <i class="icon {{tag | lowercase}}" tooltip="{{tag}}"></i>
                <span class="label {{tag | lowercase}}">{{tag}}</span>
              </span>
            </td>
            <td>
              <div class="progress progress-container deploy-progress" ng-class="{'deploy-complete': deployment.progress != 100}">
                <div class="bar {{ deployment.display_status | barClass }}" ng-style="{width: deployment.progress + '%'}">
                </div>
                <span>{{deployment.display_status}}</span>
              </div>
            </td>
            <td>
              {{deployment.created | formattedFullDate}}<span ng-show="deployment.created_by"> by {{deployment.created_by}}</span>
            </td>
          </tr>

          <tr class="messages">
            <td colspan="6">
              <div ng-show="has_pending_results()">
                <img class="loading" src="/img/ajax-loader.gif" />
                Loading more results...
              </div>

              <div ng-show="no_results_found()">
                No deployments found. =(
              </div>

              <div ng-show="error_message">
                {{error_message}}
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      <div data-ng-include data-src="'/partials/shared/pagination.html'"></div>
    </div>
  </div>
</div>
